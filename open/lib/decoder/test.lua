-- 
-- file: test.lua
-- auth: chenjf
-- date: 2014
-- desc:
--

local decoder = require('libluadecoder')
local socket = require('socket')
local tab_test = {
    [1] = "84*12@1402672091|1402672094|726277870572135|K0vil8lQ0u|946002516717259|130614150811|1065209807|295922613|282|341|92|SR8mGjllQw|1402672092|1402672094|726277870572135|K0vil8lQ0u|946002516717259|130614150812|1065208987|295924825|283|342|92|SR8mGjllQw|1402672093|1402672094|726277870572135|K0vil8lQ0u|946002516717259|130614150813|1065208158|295927020|284|342|92|SR8mGjllQw|1402672094|1402672094|726277870572135|K0vil8lQ0u|946002516717259|130614150814|1065207338|295929233|284|342|92|SR8mGjllQw|1402672095|1402672094|726277870572135|K0vil8lQ0u|946002516717259|130614150815|1065206562|295931435|284|342|93|SR8mGjllQw|1402672096|1402672099|726277870572135|K0vil8lQ0u|946002516717259|130614150816|1065205772|295933677|284|342|93|SR8mGjllQw|1402672097|1402672099|726277870572135|K0vil8lQ0u|946002516717259|130614150817|1065204988|295935935|283|342|94|SR8mGjllQw|1402672098|1402672099|726277870572135|K0vil8lQ0u|946002516717259|130614150818|1065204172|295938213|283|342|95|SR8mGjllQw|1402672099|1402672099|726277870572135|K0vil8lQ0u|946002516717259|130614150819|1065203343|295940505|283|342|95|SR8mGjllQw|1402672100|1402672099|726277870572135|K0vil8lQ0u|946002516717259|130614150820|1065202515|295942802|283|342|96|SR8mGjllQw|1402672101|1402672104|726277870572135|K0vil8lQ0u|946002516717259|130614150821|1065201657|295945143|282|342|98|SR8mGjllQw|1402672103|1402672104|726277870572135|K0vil8lQ0u|946002516717259|130614150823|1065199887|295949882|280|341|99|SR8mGjllQw|1402672104|1402672104|726277870572135|K0vil8lQ0u|946002516717259|130614150824|1065198988|295952275|280|341|100|SR8mGjllQw|1402672105|1402672104|726277870572135|K0vil8lQ0u|946002516717259|130614150825|1065198077|295954643|278|341|98|SR8mGjllQw|1402672106|1402672109|726277870572135|K0vil8lQ0u|946002516717259|130614150826|1065197139|295956965|277|340|98|SR8mGjllQw|1402672107|1402672109|726277870572135|K0vil8lQ0u|946002516717259|130614150827|1065196130|295959325|277|339|100|SR8mGjllQw|1402672108|1402672109|726277870572135|K0vil8lQ0u|946002516717259|130614150828|1065195083|295961735|276|339|102|SR8mGjllQw|1402672109|1402672109|726277870572135|K0vil8lQ0u|946002516717259|130614150829|1065194027|295964128|275|338|102|SR8mGjllQw|1402672111|1402672109|726277870572135|K0vil8lQ0u|946002516717259|130614150831|1065191793|295968875|274|336|103|SR8mGjllQw|1402672111|1402672114|726277870572135|K0vil8lQ0u|946002516717259|130614150831|1065191793|295968875|274|336|103|SR8mGjllQw|1402672112|1402672114|726277870572135|K0vil8lQ0u|946002516717259|130614150832|1065190582|295971227|274|335|102|SR8mGjllQw|1402672113|1402672114|726277870572135|K0vil8lQ0u|946002516717259|130614150833|1065189343|295973533|273|334|102|SR8mGjllQw|1402672114|1402672114|726277870572135|K0vil8lQ0u|946002516717259|130614150834|1065188060|295975820|273|333|101|SR8mGjllQw|1402672115|1402672114|726277870572135|K0vil8lQ0u|946002516717259|130614150835|1065186762|295978038|272|332|98|SR8mGjllQw|1402672116|1402672119|726277870572135|K0vil8lQ0u|946002516717259|130614150836|1065185468|295980202|272|332|96|SR8mGjllQw|1402672117|1402672119|726277870572135|K0vil8lQ0u|946002516717259|130614150837|1065184167|295982337|273|331|96|SR8mGjllQw|1402672118|1402672119|726277870572135|K0vil8lQ0u|946002516717259|130614150838|1065182853|295984472|273|331|96|SR8mGjllQw|1402672119|1402672119|726277870572135|K0vil8lQ0u|946002516717259|130614150839|1065181562|295986617|273|332|96|SR8mGjllQw|1402672120|1402672119|726277870572135|K0vil8lQ0u|946002516717259|130614150840|1065180288|295988763|273|332|96|SR8mGjllQw|1402672121|1402672124|726277870572135|K0vil8lQ0u|946002516717259|130614150841|1065179028|295990890|273|332|95|SR8mGjllQw|1402672122|1402672124|726277870572135|K0vil8lQ0u|946002516717259|130614150842|1065177760|295992977|273|331|94|SR8mGjllQw|1402672123|1402672124|726277870572135|K0vil8lQ0u|946002516717259|130614150843|1065176472|295995048|273|331|94|SR8mGjllQw|1402672124|1402672124|726277870572135|K0vil8lQ0u|946002516717259|130614150844|1065175187|295997122|274|331|94|SR8mGjllQw|1402672125|1402672124|726277870572135|K0vil8lQ0u|946002516717259|130614150845|1065173900|295999192|274|331|93|SR8mGjllQw|1402672126|1402672129|726277870572135|K0vil8lQ0u|946002516717259|130614150846|1065172597|296001260|274|331|93|SR8mGjllQw|1402672127|1402672129|726277870572135|K0vil8lQ0u|946002516717259|130614150847|1065171307|296003337|275|331|94|SR8mGjllQw|1402672128|1402672129|726277870572135|K0vil8lQ0u|946002516717259|130614150848|1065170007|296005405|275|331|94|SR8mGjllQw|1402672130|1402672129|726277870572135|K0vil8lQ0u|946002516717259|130614150850|1065167347|296009580|275|331|95|SR8mGjllQw|1402672131|1402672129|726277870572135|K0vil8lQ0u|946002516717259|130614150851|1065166030|296011673|275|331|94|SR8mGjllQw|1402672146|1402672173|726277870572135|K0vil8lQ0u|946002516717259|130614150906|1065159737|296047392|275|2|96|SR8mGjllQw|1402672147|1402672173|726277870572135|K0vil8lQ0u|946002516717259|130614150907|1065159875|296049772|275|1|95|SR8mGjllQw|1402672148|1402672173|726277870572135|K0vil8lQ0u|946002516717259|130614150908|1065159967|296052117|276|1|94|SR8mGjllQw|1402672149|1402672173|726277870572135|K0vil8lQ0u|946002516717259|130614150909|1065160068|296054435|275|2|92|SR8mGjllQw|1402672150|1402672173|726277870572135|K0vil8lQ0u|946002516717259|130614150910|1065160222|296056695|276|3|91|SR8mGjllQw|1402672151|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150911|1065160392|296058932|277|3|89|SR8mGjllQw|1402672152|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150912|1065160558|296061157|277|4|88|SR8mGjllQw|1402672153|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150913|1065160737|296063308|277|3|85|SR8mGjllQw|1402672154|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150914|1065160843|296065415|277|2|84|SR8mGjllQw|1402672155|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150915|1065160877|296067527|278|0|83|SR8mGjllQw|1402672156|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150916|1065160920|296069582|278|1|81|SR8mGjllQw|1402672157|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150917|1065160990|296071608|277|1|80|SR8mGjllQw|1402672158|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150918|1065161092|296073585|277|2|79|SR8mGjllQw|1402672159|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150919|1065161215|296075550|276|3|77|SR8mGjllQw|1402672160|1402672174|726277870572135|K0vil8lQ0u|946002516717259|130614150920|1065161350|296077482|276|3|76|SR8mGjllQw|1402672171|1402672176|726277870572135|K0vil8lQ0u|946002516717259|130614150931|1065162645|296096330|278|3|60|SR8mGjllQw|1402672172|1402672176|726277870572135|K0vil8lQ0u|946002516717259|130614150932|1065162728|296097860|279|4|59|SR8mGjllQw|1402672173|1402672176|726277870572135|K0vil8lQ0u|946002516717259|130614150933|1065162847|296099328|278|3|58|SR8mGjllQw|1402672174|1402672176|726277870572135|K0vil8lQ0u|946002516717259|130614150934|1065162965|296100833|279|3|60|SR8mGjllQw|1402672176|1402672176|726277870572135|K0vil8lQ0u|946002516717259|130614150936|1065163220|296103893|279|3|61|SR8mGjllQw|1402672176|1402672179|726277870572135|K0vil8lQ0u|946002516717259|130614150936|1065163220|296103893|279|3|61|SR8mGjllQw|1402672177|1402672179|726277870572135|K0vil8lQ0u|946002516717259|130614150937|1065163328|296105442|279|3|61|SR8mGjllQw|1402672178|1402672179|726277870572135|K0vil8lQ0u|946002516717259|130614150938|1065163452|296106972|280|4|61|SR8mGjllQw|1402672180|1402672179|726277870572135|K0vil8lQ0u|946002516717259|130614150940|1065163710|296110088|281|4|62|SR8mGjllQw|1402672181|1402672179|726277870572135|K0vil8lQ0u|946002516717259|130614150941|1065163874|296111703|281|5|64|SR8mGjllQw|1402672181|1402672187|726277870572135|K0vil8lQ0u|946002516717259|130614150941|1065163874|296111703|281|5|64|SR8mGjllQw|1402672183|1402672187|726277870572135|K0vil8lQ0u|946002516717259|130614150943|1065164327|296115020|281|7|67|SR8mGjllQw|1402672184|1402672187|726277870572135|K0vil8lQ0u|946002516717259|130614150944|1065164627|296116692|281|9|67|SR8mGjllQw|1402672185|1402672187|726277870572135|K0vil8lQ0u|946002516717259|130614150945|1065164972|296118350|281|10|67|SR8mGjllQw|1402672186|1402672187|726277870572135|K0vil8lQ0u|946002516717259|130614150946|1065165365|296119997|281|12|66|SR8mGjllQw|1402672187|1402672190|726277870572135|K0vil8lQ0u|946002516717259|130614150947|1065165813|296121633|281|13|67|SR8mGjllQw|1402672188|1402672190|726277870572135|K0vil8lQ0u|946002516717259|130614150948|1065166305|296123262|281|14|67|SR8mGjllQw|1402672189|1402672190|726277870572135|K0vil8lQ0u|946002516717259|130614150949|1065166842|296124893|280|16|67|SR8mGjllQw|1402672190|1402672190|726277870572135|K0vil8lQ0u|946002516717259|130614150950|1065167427|296126512|280|17|67|SR8mGjllQw|1402672191|1402672190|726277870572135|K0vil8lQ0u|946002516717259|130614150951|1065168045|296128102|280|18|66|SR8mGjllQw|1402672192|1402672195|726277870572135|K0vil8lQ0u|946002516717259|130614150952|1065168740|296129712|280|20|68|SR8mGjllQw|1402672193|1402672195|726277870572135|K0vil8lQ0u|946002516717259|130614150953|1065169488|296131320|280|22|68|SR8mGjllQw|1402672194|1402672195|726277870572135|K0vil8lQ0u|946002516717259|130614150954|1065170275|296132912|280|23|68|SR8mGjllQw|1402672195|1402672195|726277870572135|K0vil8lQ0u|946002516717259|130614150955|1065171105|296134467|280|25|67|SR8mGjllQw|1402672196|1402672195|726277870572135|K0vil8lQ0u|946002516717259|130614150956|1065171970|296136002|280|26|67|SR8mGjllQw|1402672197|1402672200|726277870572135|K0vil8lQ0u|946002516717259|130614150957|1065172885|296137517|280|28|67|SR8mGjllQw|1402672198|1402672200|726277870572135|K0vil8lQ0u|946002516717259|130614150958|1065173818|296139015|280|29|67|SR8mGjllQw|1402672199|1402672200|726277870572135|K0vil8lQ0u|946002516717259|130614150959|1065174827|296140492|280|30|68|SR8mGjllQw|1402672200|1402672200|726277870572135|K0vil8lQ0u|946002516717259|130614151000|1065175864|296141958|280|32|68|SR8mGjllQw|1402672201|1402672200|726277870572135|K0vil8lQ0u|946002516717259|130614151001|1065176938|296143368|280|33|67|SR8mGjllQw|",
}

local function test_urldecode()

    for i=1,#tab_test do
        print(tab_test[i])
    end
    local costtime = 0.0;
    local begin = socket.gettime()
    local tab = decoder.decode(1, tab_test)
    if not tab then
        print("url decode error.")
        return
    end

    print("table len: "..#tab)
    for i=1,#tab do
        for j=1,#(tab[i]) do
            print("[".. i .. "]" .. "[" .. j .."]: " .. tab[i][j])
        end
    end

    costtime = socket.gettime() - begin
    print("cost time: ".. costtime)

end

test_urldecode()

